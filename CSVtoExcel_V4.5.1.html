# CSVtoExcel_V4.5.1.htmlï¼ˆå–®æª”ã€å·²æ•´åˆä¸»é¡Œåˆ‡æ›èˆ‡äººæ€§åŒ–æŒ‰éˆ•ï¼‰

```html
<!DOCTYPE html>
<html lang="zh-Hant" data-version="4.5.1">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CSV è½‰ Excel å·¥å…· V4.5.1</title>

  <!-- ç¬¬ä¸‰æ–¹å‡½å¼åº«ï¼ˆCDN ç‰ˆï¼‰ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <style>
    /* =========================
     * ä¸»é¡Œè®Šæ•¸ï¼ˆé è¨­ï¼šlinkedin å»¶ä¼¸ï¼‰
     * ========================= */
    :root {
      --bg: #eef5ff; --card:#ffffff; --text:#102a43; --muted:#64748b;
      --accent:#0a66c2; --accent-2:#2b7de9; --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
      --border:#e5e7eb; --chip-bg:#eff6ff; --chip-text:#1d4ed8;
      --radius:16px; --shadow:0 12px 28px rgba(0,0,0,.12);
    }
    /* GitHub Neutral */
    body[data-theme="github"] {
      --bg:#f6f8fa; --card:#fff; --text:#1f2328; --muted:#6e7781;
      --accent:#0969da; --accent-2:#1f6feb; --ok:#2da44e; --warn:#9a6700; --danger:#cf222e;
      --border:#d0d7de; --chip-bg:#ddf4ff; --chip-text:#0969da;
    }
    /* Police Navy & Amber */
    body[data-theme="police"] {
      --bg:#0b111e; --card:#0e1526; --text:#e6edf3; --muted:#8b97a7;
      --accent:#133e87; --accent-2:#1f54b5; --ok:#3ddc97; --warn:#ffc043; --danger:#ff6b6b;
      --border:#1f2a3d; --chip-bg:rgba(255,192,67,0.12); --chip-text:#ffc043;
    }

    /* ========== åŸºæœ¬ä½ˆå±€ ========== */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,'Microsoft JhengHei',sans-serif;
           color:var(--text); background: linear-gradient(to bottom, var(--bg), color-mix(in srgb, var(--bg) 80%, #000 20%)); }
    .container { width:min(1100px,94vw); margin:clamp(16px,3.6vw,48px) auto; background:var(--card);
                 border-radius:var(--radius); box-shadow:var(--shadow); padding:clamp(16px,3.2vw,36px); }

    /* Header å€ï¼šæ¨™é¡Œ + ä¸»é¡Œåˆ‡æ›æŒ‰éˆ• */
    .header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:10px; }
    h1 { margin:0; font-size:clamp(20px,3.2vw,28px); letter-spacing:.3px; color:var(--accent); }
    .sub { color:var(--muted); font-size:13px; margin:6px 0 0; }

    /* ä¸»é¡ŒæŒ‰éˆ•ï¼ˆæ›´äººæ€§åŒ–ï¼šä¸€éµåˆ‡æ›ï¼‰ */
    .themes { display:flex; gap:8px; }
    .theme-btn { display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:999px; border:1px solid var(--border);
                 background:#fff0; color:var(--text); cursor:pointer; font-weight:600; }
    .theme-btn:hover { background:color-mix(in srgb, var(--accent) 10%, transparent); }
    .theme-btn.active { outline:2px solid var(--accent); outline-offset:2px; }

    /* å³æ™‚çµ±è¨ˆ chip */
    .stats { display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 16px; }
    .chip { font-size:12px; padding:6px 12px; border-radius:999px; background:var(--chip-bg); color:var(--chip-text); font-weight:700; border:1px solid var(--border); }

    /* æ‹–æ›³å€ */
    .dropzone { border:2.5px dashed var(--accent); padding:clamp(18px,4vw,28px); border-radius:14px; text-align:center; color:var(--muted);
                background:color-mix(in srgb, var(--accent) 4%, white 96%); transition:.2s ease; margin-bottom:18px; }
    .dropzone:hover { background:color-mix(in srgb, var(--accent) 8%, white 92%); }
    .dropzone.active { background:color-mix(in srgb, var(--accent) 16%, white 84%); box-shadow:0 0 0 3px color-mix(in srgb, var(--accent) 35%, transparent); }

    /* å·¥å…·åˆ—ï¼ˆæ›´äººæ€§åŒ–åˆ†çµ„ï¼‰ */
    .toolbar { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin:10px 0 10px; }
    .toolbar .group { display:flex; flex-wrap:wrap; gap:10px; align-items:center; }
    .toolbar .group.primary { flex:1; }

    .btn { display:inline-flex; align-items:center; gap:8px; border:1px solid var(--border); padding:10px 14px; border-radius:12px;
           background:var(--accent); color:#fff; cursor:pointer; font-weight:700; box-shadow:0 6px 14px rgba(10,102,194,.15);
           transition:transform .06s ease, box-shadow .2s ease, background .2s ease; }
    .btn:hover { background:var(--accent-2); box-shadow:0 10px 18px rgba(10,102,194,.25); }
    .btn:active { transform:translateY(1px); }
    .btn.secondary { background:transparent; color:var(--text); box-shadow:none; }
    .btn.secondary:hover { background:color-mix(in srgb, var(--accent) 10%, transparent); }

    .switch { display:inline-flex; align-items:center; gap:8px; user-select:none; padding:6px 10px; border-radius:10px; border:1px dashed var(--border); }
    .switch input { appearance:none; width:44px; height:24px; background:#d1d5db; border-radius:999px; position:relative; outline:none; cursor:pointer; transition:background .2s ease; }
    .switch input:checked { background:#60a5fa; }
    .switch input::after { content:""; position:absolute; top:3px; left:3px; width:18px; height:18px; border-radius:999px; background:#fff; transition:transform .2s ease; }
    .switch input:checked::after { transform:translateX(20px); }
    .switch span { color:var(--muted); font-weight:600; }

    .text { border:1px solid var(--border); padding:10px 12px; border-radius:12px; min-width:260px; max-width:min(520px,80vw); }
    .hint { font-size:12px; color:var(--muted); margin-top:6px; }

    /* æª”ååˆ—èˆ‡æ¸…å–® */
    .filename-list { margin-top:12px; font-size:13px; max-height:240px; overflow:auto; border:1px solid var(--border); background:var(--card); border-radius:12px; padding:10px; }
    .file-row { display:flex; justify-content:space-between; align-items:center; gap:8px; padding:6px 4px; border-bottom:1px dashed var(--border); }
    .file-row:last-child { border-bottom:0; }
    .file-name { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .badge { font-size:11px; padding:2px 8px; border-radius:999px; background:var(--chip-bg); color:var(--chip-text); font-weight:700; }

    /* é€²åº¦åˆ— */
    .progress { width:100%; height:14px; background:#e5e7eb; border-radius:999px; overflow:hidden; margin-top:14px; border:1px solid var(--border); }
    .progress-bar { height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent-2)); transition:width .35s ease; }

    /* æ—¥èªŒ */
    .log { margin-top:14px; }
    .log h3 { margin:18px 0 8px; font-size:14px; color:var(--muted); }
    .log-box { height:280px; overflow:auto; border:1px solid var(--border); border-radius:12px; background:var(--card);
               padding:10px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,'Liberation Mono',monospace; font-size:12px; }

    /* Toast */
    .toast { position:fixed; inset:auto 12px 12px auto; background:#111827; color:#fff; padding:10px 14px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.25); opacity:0; transform:translateY(8px); pointer-events:none; transition:.25s ease; z-index:50; }
    .toast.show { opacity:1; transform:translateY(0); }

    /* æš—è‰²ä¸»é¡Œé¡å¤–ä¿®é£¾ï¼ˆpoliceï¼‰ */
    body[data-theme="police"] .container { background: rgba(14,21,38,.92); box-shadow: 0 20px 60px rgba(0,0,0,.45); }
    body[data-theme="police"] .dropzone { background: rgba(255,255,255,.04); }
    body[data-theme="police"] .filename-list, body[data-theme="police"] .log-box { background: rgba(255,255,255,.03); }
  </style>
</head>
<body data-theme="linkedin">
  <div class="container">
    <div class="header">
      <div>
        <h1>CSV è½‰ Excel å·¥å…· V4.5.1</h1>
        <p class="sub">æ‹–æ›³ <b>CSV æª”æˆ–è³‡æ–™å¤¾</b> é€²ä¾†ï¼Œæˆ–ç”¨ä¸‹æ–¹æŒ‰éˆ•é¸å–ã€‚è‡ªå‹•åµæ¸¬ç·¨ç¢¼ï¼ˆUTF-8ï¼Big5ï¼GB18030ï¼‰ã€é‡‘é¡è‡ªå‹•æ ¼å¼ï¼ˆ#,##0ï¼‰ã€é¿å…ç§‘å­¸è¨˜è™Ÿã€‚</p>
      </div>
      <div class="themes" aria-label="ä¸»é¡Œåˆ‡æ›">
        <button id="btnThemeGithub" class="theme-btn" title="GitHub Neutral">ğŸŸ¦ GitHub</button>
        <button id="btnThemePolice" class="theme-btn" title="Police Navy & Amber">ğŸ›¡ï¸ Police</button>
      </div>
    </div>

    <!-- å³æ™‚çµ±è¨ˆ -->
    <div class="stats">
      <div class="chip" id="chip-files">æª”æ¡ˆ 0</div>
      <div class="chip" id="chip-expense">æ”¯å‡ºåˆè¨ˆ 0</div>
      <div class="chip" id="chip-income">å­˜å…¥åˆè¨ˆ 0</div>
      <div class="chip" id="chip-balance">é¤˜é¡åˆè¨ˆ 0</div>
    </div>

    <div id="dropzone" class="dropzone" tabindex="0" aria-label="æ‹–æ›³å€">
      <div style="display:flex; flex-direction:column; align-items:center; gap:8px;">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 15.5a4.5 4.5 0 0 0-4.5-4.5h-.28A5.5 5.5 0 0 0 5 9.5 4.5 4.5 0 0 0 4.5 18H17" stroke="#3b82f6" stroke-width="1.5" stroke-linecap="round"/></svg>
        <div class="muted">ğŸ‘‰ å°‡æª”æ¡ˆæˆ–è³‡æ–™å¤¾æ‹–æ›³åˆ°æ­¤è™•</div>
      </div>
    </div>

    <!-- å·¥å…·åˆ—ï¼šæ›´äººæ€§åŒ–é…ç½®ï¼ˆä¸»è¦æ“ä½œåœ¨å·¦ï¼Œè¼”åŠ©åœ¨å³ï¼‰ -->
    <div class="toolbar">
      <div class="group primary">
        <input id="picker" type="file" multiple webkitdirectory directory accept=".csv" style="display:none" />
        <button class="btn" id="btnPick" title="é¸æ“‡ CSV æˆ–æ•´å€‹è³‡æ–™å¤¾">
          ğŸ“‚ é¸æ“‡æª”æ¡ˆ/è³‡æ–™å¤¾
        </button>
        <button class="btn" id="btnStart" title="åŸæ¨¡å¼ï¼šé€æª”è¼¸å‡ºæˆ–åˆä½µæˆä¸€å€‹ Excel">
          â–¶ï¸ é–‹å§‹è½‰æ›ï¼ˆåŸæ¨¡å¼ï¼‰
        </button>
        <button class="btn" id="btnGroupByHeader" title="å…ˆè¦æ ¼åŒ–æ¨™é¡Œï¼Œå†æŠŠç›¸åŒçµ„åˆä½µåˆ°åŒä¸€åˆ†é ">
          ğŸ§© ä¾æ¨™é¡Œåˆä½µæˆåˆ†é 
        </button>
      </div>
      <div class="group">
        <label class="switch" title="åˆä½µå¤šæª”åˆ°å–®ä¸€ Excelï¼ˆåŸæ¨¡å¼ç”¨ï¼‰">
          <input type="checkbox" id="mergeMode" checked />
          <span>åˆä½µæˆä¸€å€‹ Excel</span>
        </label>
        <button class="btn secondary" id="btnClear" title="æ¸…ç©ºæ¸…å–®èˆ‡çµ±è¨ˆ">ğŸ§¹ æ¸…é™¤</button>
      </div>
    </div>

    <!-- æª”åæ¬„ä½ï¼ˆå…©ç¨®æ¨¡å¼çš†é©ç”¨ï¼‰ -->
    <div class="toolbar" style="margin-top:0;">
      <div class="group primary">
        <input id="mergeFilename" class="text" type="text" placeholder="è¼¸å‡ºæª”åï¼ˆå…©ç¨®æ¨¡å¼çš†é©ç”¨ï¼Œçœç•¥å‰‡è‡ªå‹•ç”¢ç”Ÿï¼‰" />
        <div class="hint">åŸæ¨¡å¼ï¼šè‹¥å‹¾é¸ã€Œåˆä½µæˆä¸€å€‹ Excelã€å‰‡ä½¿ç”¨æ­¤åç¨±ã€‚æ¨™é¡Œåˆä½µæ¨¡å¼ï¼šå„ªå…ˆæ¡ç”¨æ­¤åç¨±ã€‚</div>
      </div>
    </div>

    <div id="fileList" class="filename-list" aria-live="polite"></div>
    <div class="progress"><div id="bar" class="progress-bar"></div></div>
    <div class="hint">è¦æ ¼åŒ–é‡é»ï¼š<b>æˆ¶å â‰  å¸³è™Ÿ</b>ã€<b>æ‰¿ç§Ÿäºº</b>èˆ‡<b>è¢«å®³äºº</b>ä¸åˆä½µã€ã€Œè³‡æ–™æä¾›æ—¥å¸³æˆ¶é¤˜é¡/çµé¤˜ã€çµ±ä¸€ç‚ºã€Œè³‡æ–™æä¾›æ—¥å¸³æˆ¶çµé¤˜ã€ã€‚ç”¢å‡º <b>000_HeaderMap</b> å¯æª¢è¦–å°ç…§ã€‚</div>

    <div class="log">
      <h3>æ—¥èªŒè¼¸å‡º</h3>
      <div id="log" class="log-box" role="log"></div>
    </div>
  </div>

  <div id="toast" class="toast" role="status"></div>

  <!-- ä¸»é‚è¼¯ -->
  <script src="app.js"></script>
</body>
</html>
