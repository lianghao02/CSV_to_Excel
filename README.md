CSV 轉 Excel 工具

把多個 CSV 檔（或整個資料夾）拖曳到頁面，一鍵輸出 Excel（.xlsx）。
支援台灣常見編碼（UTF-8／Big5／GB18030）自動偵測，避免亂碼。提供金額欄位格式化、統計、合併、以及「依規格化標題分頁」等進階功能。

新手友善：直接開 index.html 就能用，不用打指令、不用後端。

✨ 主要功能

自動編碼偵測：UTF-8／Big5／GB18030，自動選最合理解碼，避免亂碼。

金額欄位自動整理：支出金額/存入金額/餘額 去逗號與 +，截去小數（不四捨五入）；Excel 顯示格式 #,##0。

統計列：即時顯示「支出合計／存入合計／餘額合計」。

避免科學記號：指定欄位強制為文字（z='@'），如「交易日期／帳號／電話」等。

合併輸出：

原模式：每個 CSV 轉成一個分頁（或個別檔）。

依規格化標題合併（V4.5+）：同一組（寬鬆比對後）標題的資料放同一分頁，不同來源用空白列分隔；分頁命名 001/002/…。

標題寬鬆比對／規格化（V4.5.1）：

自動修正空白、全半形、標點、括號說明（交易行(或所屬分行代號) → 交易行）

常見錯別字／缺字（端未機/端末機、身分證統編號、資料提供日 等）

近似字（Levenshtein ≤ 2）自動對齊到正規名

產出 000_HeaderMap 分頁列出「原始標題 → 規格化後標題」與分頁歸屬，方便複核

UX 小強化：拖放資料夾、重複路徑自動跳過、欄寬自動、AutoFilter、日誌最多 500 行等。

🗂 檔案結構
/ (repo root)
├─ index.html                 # 入口（會自動導向最新版頁面）
├─ CSVtoExcel_V4.5.1.html     # 最新主頁（可改版號）
├─ app.js                     # 主要程式碼（保持與版號一致）
└─ LICENSE (建議用 MIT)


外掛（CDN）：

[SheetJS xlsx 0.18.5]、[PapaParse 5.4.1]、[FileSaver 2.0.5]（在 HTML 以 <script> 引入）

🚀 使用方式（本機 / GitHub Pages）
本機使用

下載整個專案（或用 GitHub Desktop Clone）。

直接雙擊打開 index.html（或 CSVtoExcel_V4.5.1.html）。

將 CSV 檔或資料夾 拖曳到頁面，點「開始轉換（原模式）」或「依標題合併成分頁」。

注意：Safari/Chrome/Edge 都可使用；若公司環境限制本機檔讀取，請改用 GitHub Pages。

發佈到 GitHub Pages

把這個專案 Push 到 GitHub。

進入 Settings → Pages：

Source 選 Deploy from a branch

Branch 選 main（或你的預設分支）與 / (root)

儲存後等幾十秒，GitHub 會給你一個網址，打開即用（https://<你的帳號>.github.io/<repo>）。

之後更新版本時：把 CSVtoExcel_V4.X.X.html 與 index.html 裡的 ?v=YYYYMMDD-x 一起更新（避免快取）。

🧭 操作流程

加入檔案：拖曳 CSV 或資料夾進頁面，或按「選擇 CSV / 資料夾」。

選模式：

原模式：勾「合併成一個 Excel」→ 所有 CSV 變各分頁；不勾則每個 CSV 轉成一個 xlsx。

依標題合併成分頁：按新按鈕，會依規格化後標題把多個來源併到同分頁（分頁名 001/002…）；不同來源會以一列空白分隔。

下載結果：自動觸發下載。若是依標題合併，會多一張 000_HeaderMap 供你檢視「原始欄名 → 規格化後欄名」。

🔧 客製化（常見調整）
1) 調整「規格化標題」對照

打開 app.js 找到 HEADER_ALIASES：
新增你的變體即可（左邊是正規名，右邊是可能出現的別名）。

const HEADER_ALIASES = {
  "身分證統一編號": ["身分證統編號","身份證統一編號","身份證統編號","身分證號"],
  "ATM或端末機代碼": ["端未機代碼","端末機代碼","ATM/端末機代碼"],
  // 在這裡加自己的別名…
};


若遇到沒列在表內，但「只有 1~2 個字差」的情況，系統也會用近似比對自動歸入。

2) 指定文字欄（避免科學記號）
const FORCE_TEXT_FIELDS = ["交易日期","交易時間","帳號","住家電話","行動電話"];

3) 金額欄位
const AMOUNT_FIELDS = ["支出金額","存入金額","餘額"];


自動去 , 與 +，負號保留，小數截斷（不四捨五入）。

Excel 顯示 #,##0；空值不強制顯示 0。

🧪 瀏覽器支援

最新版 Chrome / Edge / Safari。

需要 TextDecoder('big5') / ('gb18030')（現代瀏覽器都有）。若舊版瀏覽器無法正確 Big5 解析，請升級或改用 Chrome。

🩺 疑難排解

Q：中文亂碼？
A：本專案會從 UTF-8／Big5／GB18030 自動挑最合理。仍亂碼時，原檔可能混雜控制字元或為更冷門編碼—請先用記事本另存為 UTF-8，再匯入。

Q：同一份表頭有兩欄 交易日期？
A：我們在「分群簽名」前會去重，實際輸出保留第一欄。你可在 000_HeaderMap 檢視來源對照。

Q：不同來源被併在一起了，但我想拆開？
A：依標題合併模式會以規格化後的表頭為準；你可以暫時移除 HEADER_ALIASES 中的某些對應，或先用原模式輸出。

Q：檔案很多、很大，效能變慢？
A：建議分批處理；或先用原模式輸出再在 Excel 合併；避免同時載入上千個大型 CSV。

🧱 安全與隱私

全程在瀏覽器端執行，不會上傳到伺服器。

僅使用公開 CDN 的前端函式庫。企業內網可改成自架 CDN 或改用離線檔案。

🗓 版本紀錄

V4.5.1

規格化再合併：空白/全半形/標點/括號說明/常見錯別字/近似字（≤2）

新增 000_HeaderMap 分頁（原始標題→規格化標題、分頁對應）

依規格化標題分群，分頁名 001/002/…

V4.5.0

新增「依標題合併成分頁」按鈕；相同（寬鬆比對）表頭合併，來源間插入空白行；分頁 001/002…

V4.4.4

自動偵測編碼（UTF-8/Big5/GB18030）；金額整形顯示；保留 4.4.2/4.4.3 修正

若你要釋出新版本，請同時更新：

檔名：CSVtoExcel_Vx.y.z.html

index.html 中的導向網址與 ?v=YYYYMMDD-x 版本參數

app.js 內檔頭版號註解

👷‍♀️ 開發筆記

欄寬計算採中英文視覺寬度估算，取樣前 N 列以避免巨量資料卡頓。

金額欄位單獨規則處理，避免被文字欄判定覆蓋。

近似比對使用簡易 Levenshtein，閾值 2；如需更嚴謹可引入專門套件。

🤝 貢獻與回報問題

歡迎提 PR / Issue：

Bug 回報：附上（可匿名化）CSV 範例、瀏覽器版本與操作步驟。

欄名規格化擴充：請在 app.js 的 HEADER_ALIASES 增補測得的別名，或開 Issue 提供清單。