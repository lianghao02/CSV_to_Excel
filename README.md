📄 CSV 轉 Excel 工具 V4.3

一個簡單易用的 網頁工具，可將多個 CSV 檔案批次轉換為 Excel (.xlsx) 格式，支援 合併模式 與 單檔輸出。
只要打開網頁、拖曳 CSV 檔案或資料夾即可完成轉換，無需安裝額外軟體。

✨ 功能特色

📂 支援多檔與資料夾拖曳：一次匯入多個 CSV 檔案或整個資料夾。

🔄 合併模式：將所有 CSV 檔案合併到一個 Excel 檔，分成多個工作表。

📑 單檔模式：每個 CSV 會轉換成獨立的 Excel 檔。

🧾 智慧格式判斷：

長數字（如帳號、電話號碼）強制保留文字格式，避免科學記號。

數字欄位自動轉換為數值格式。

⏳ 進度條 + 日誌輸出：即時顯示轉換進度與處理紀錄。

🎯 跨平台支援：純前端執行，不需伺服器，任何瀏覽器皆可使用。

🚀 使用方式

開啟 index.html（本專案單檔即可運行）。

將 CSV 檔案或資料夾 拖曳 到工具畫面，或點擊按鈕選取檔案。

選擇輸出模式：

✅ 合併模式（預設開啟）：所有 CSV 會輸出到一個 Excel 檔，每個 CSV 對應一個工作表。

❌ 單檔模式（取消勾選）：每個 CSV 會輸出為獨立的 Excel 檔。

點擊 「開始轉換」。

下載完成的 Excel 檔案。

🛠 技術堆疊

PapaParse
 → 解析 CSV

SheetJS (xlsx)
 → 生成 Excel

FileSaver.js
 → 下載檔案

📂 專案結構
CSV-to-Excel/
│
├── index.html   # 主程式 (包含 HTML、CSS、JavaScript)
└── README.md    # 使用說明文件

📸 介面預覽

拖曳區域（支援檔案 / 資料夾）

檔案清單顯示

進度條 + 日誌輸出

📝 版本資訊

V4.3 (正式版)

新增資料夾批次匯入功能

新增進度條與日誌輸出

優化合併模式邏輯

改善欄位格式偵測，避免帳號/電話變成科學記號

_______________________________________________________________________________________________________________________________________________
CSV 轉 Excel 工具 v4.4.1 更新內容（Changelog）

發行日期：2025-09-18
重點：修正 CSV 解析非同步造成的錯誤、日誌一行一訊息、拖曳區與按鈕間距微調，維持 4.4 的自動欄寬與去重策略。

🛠 修正（Fixes）

Papa Parse 同步解析：由於 4.4 對字串搭配 worker:true 會走非同步回呼，導致在取用 csv.data 當下為 undefined。

改為同步：Papa.parse(text, { header: true, skipEmptyLines: 'greedy' })。

加入防呆：檢查 csv && csv.meta && Array.isArray(csv.data)，否則提示「CSV 解析失敗或格式不正確」。

BOM 去除：讀檔後若遇到 U+FEFF 先剔除，避免標題偵測失敗。

範例差異

- const csv = Papa.parse(text, { header: true, skipEmptyLines: 'greedy', worker: true });
- let data = csv.data; // 非同步時此處可能為 undefined
+ const csv = Papa.parse(text, { header: true, skipEmptyLines: 'greedy' });
+ if (!csv || !csv.meta) throw new Error('CSV 解析失敗或格式不正確');
+ const data = Array.isArray(csv.data) ? csv.data : [];

✨ 改善（Improvements）

日誌一行一訊息：log() 以 <div> 為單位新增，確保每則訊息獨立、乾淨整齊。

進度條反饋更平滑：每檔完成即更新 %。

自動欄寬：取前 50 列 + 標題估算；中文全形視為寬度 2；欄寬限制 8–50 wch。

AutoFilter：輸出工作表自動套用篩選列，提升檢視效率。

🔁 行為變更（Behavior Changes）

重複檔名策略（推薦）：以檔名為鍵，遇重複自動跳過並顯示 Toast + 日誌提示（避免誤匯與 sheet 命名衝突）。

工作表名稱唯一化：基礎名（截 31 字 + 合法化）若重複，自動加 _2/_3... 後綴。

🧩 UI/UX

拖曳區與按鈕間距調整：更清楚的視覺分群與節奏。

原生風格 + 深色模式（跟隨系統）：按鈕加簡潔 SVG 圖示、Toast 完成提示、清除清單按鈕。

拖曳資料夾：支援 webkitGetAsEntry 遞迴；不支援時回退為多檔選擇。

🔢 欄位處理（延續 4.4）

避免科學記號：指定欄（如「交易日期／時間／帳號／電話」）與**長數字欄（≥13 位）**強制為文字（cell.t='s'）。

補零規則：電話欄純數字 → 左補零至 10 碼；「交易期間」純數字 → 左補零至 6 碼。

🧪 相容性與限制

相容：合併模式與單檔輸出皆可；多資料夾拖曳（Chrome）／一般檔案選取（跨瀏覽器）。

限制：非 UTF-8（如 BIG5/CP950）目前不自動轉碼；需要時可於後續小版加入「多編碼嘗試解碼」。

🔧 升級指引

以 4.4.1 單檔覆蓋原 4.4。

無需更動設定；若要調整偵測與樣式，建議改這些常數：

FORCE_TEXT_FIELDS、LONG_NUMBER_DIGITS、SAMPLE_ROWS_FOR_WIDTH。

✅ 範例日誌（一行一訊息）
🚀 開始轉換，共 5 個檔案
處理：20250916-191-7120527Info.csv
❌ 轉換失敗：20250916-191-7120527Info.csv，原因：CSV 解析失敗或格式不正確
處理：20250916-191-7120527Intranet.csv
...
✅ 全部轉換完成

📌 版本資訊

頁面標題與主標題已更新為 V4.4.1。



📜 授權

MIT License – 可自由使用、修改、散布。

________________________________________________________________________________________________________________________________________
## 📝 版本資訊

### V4.4.3 (正式版)
- 🆕 **新增**：金額欄位自動格式化（移除「+號」、移除小數位）。
- 🛠 **改善**：維持自動欄寬、去重策略、AutoFilter、自動深色模式。
- 🐞 **修正**：避免金額被誤判為文字或保留多餘小數。

### V4.4.2
- 改進檔名去重策略（避免重複匯入）。
- 自動唯一化工作表名稱。

### V4.4.1
- 修正 CSV 解析非同步造成的錯誤。
- 加入 BOM 去除與空檔防呆。
- 日誌一行一訊息。
- 拖曳區與按鈕距離調整。

### V4.3
- 新增資料夾批次匯入功能。
- 新增進度條與日誌輸出。
- 優化合併模式邏輯。
- 改善欄位格式偵測，避免帳號/電話變成科學記號。

---


## 📜 授權

MIT License – 可自由使用、修改、散布。
"""